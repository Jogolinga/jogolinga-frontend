/* ===============================================
   QUIZ COMPONENT CSS - HARMONISÉ AVEC LE THÈME TERRE CUITE/CRÈME
   Version complète avec titre masqué et vies à droite
   =============================================== */

/* Variables CSS harmonisées avec grammarMode.css */
:root {
  /* Mode Sombre - Couleurs Terre Cuite et Crème */
  --grammar-dark-primary: #8b4513;      /* Terre cuite principal */
  --grammar-dark-secondary: #5d3317;    /* Marron foncé */
  --grammar-dark-accent: #a0522d;       /* Terre rouge */
  --grammar-dark-bg: rgba(139, 69, 19, 0.1);   /* Terre cuite transparent */
  --grammar-dark-card: rgba(139, 69, 19, 0.15); /* Terre cuite transparent */
  --grammar-dark-border: rgba(139, 69, 19, 0.3); /* Bordure terre cuite */
  --grammar-dark-text: #f5deb3;         /* Crème */
  --grammar-dark-text-secondary: #deb887; /* Beige */
  
  /* Mode Clair - Couleurs Sable/Beige */
  --grammar-light-primary: #daa520;     /* Or antique */
  --grammar-light-secondary: #cd853f;   /* Ocre */
  --grammar-light-accent: #b8860b;      /* Ocre foncé */
  --grammar-light-bg: rgba(245, 222, 179, 0.3); /* Beige transparent */
  --grammar-light-card: rgba(255, 255, 255, 0.9); /* Blanc transparent */
  --grammar-light-border: rgba(218, 165, 32, 0.4); /* Bordure or */
  --grammar-light-text: #8b4513;        /* Terre cuite */
  --grammar-light-text-secondary: #5d3317; /* Marron foncé */

  /* Espacement optimisé */
  --spacing-xs: 6px;
  --spacing-sm: 12px;
  --spacing-md: 20px;
  --spacing-lg: 32px;
  --spacing-xl: 48px;
  --spacing-2xl: 64px;
  --spacing-3xl: 80px;
  
  --transition-fast: 0.2s ease;
  --transition-normal: 0.3s ease;
  --radius-sm: 6px;
  --radius-md: 8px;
  --radius-lg: 12px;
  --radius-xl: 16px;
  --radius-full: 50%;
  
  /* Ombres harmonisées */
  --shadow-sm: 0 1px 3px rgba(139, 69, 19, 0.1);
  --shadow-md: 0 4px 6px rgba(139, 69, 19, 0.2);
  --shadow-lg: 0 10px 15px rgba(139, 69, 19, 0.3);
  --shadow-xl: 0 20px 25px rgba(139, 69, 19, 0.4);
  
  /* Variables pour bouton mobile flottant */
  --mobile-back-size: 56px;
  --mobile-back-position: 16px;
  --mobile-back-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
  --mobile-back-z-index: 1000;
}

/* RESET complet et forcé pour le Quiz */
html, body {
  margin: 0 !important;
  padding: 0 !important;
}

/* Classe spécifique pour forcer le centrage du Quiz - MOBILE OPTIMISÉ */
.quiz-force-center {
  position: fixed !important;
  top: 0 !important;
  left: 0 !important;
  width: 100vw !important;
  height: 100vh !important;
  display: flex !important;
  flex-direction: column !important;
  align-items: center !important;
  justify-content: center !important;
  z-index: 9999 !important;
  /* Dégradé harmonisé avec grammarMode.css - Mode Sombre */
  background: linear-gradient(135deg, var(--grammar-dark-primary) 0%, var(--grammar-dark-secondary) 50%, var(--grammar-dark-accent) 100%) !important;
  color: var(--grammar-dark-text) !important;
  transition: all 0.5s ease !important;
  /* Permettre le scroll vertical si nécessaire */
  overflow: hidden !important;
  padding: var(--spacing-sm) !important;
  margin: 0 !important;
}

/* Mode Clair */
.quiz-force-center[data-theme="light"] {
  background: linear-gradient(135deg, var(--grammar-light-primary) 0%, var(--grammar-light-secondary) 50%, var(--grammar-light-accent) 100%) !important;
  color: var(--grammar-light-text) !important;
}

/* Masquer tous les autres éléments quand le quiz est actif */
.quiz-force-center ~ * {
  display: none !important;
}

/* Masquer spécifiquement la mascotte et autres éléments flottants */
body:has(.quiz-force-center) .mascot-container,
body:has(.quiz-force-center) .floating-premium-button,
body:has(.quiz-force-center) .mobile-header,
body:has(.quiz-force-center) .bottom-navigation {
  display: none !important;
  visibility: hidden !important;
}

/* Alternative pour les navigateurs ne supportant pas :has() */
.quiz-active .mascot-container,
.quiz-active .floating-premium-button,
.quiz-active .mobile-header,
.quiz-active .bottom-navigation {
  display: none !important;
  visibility: hidden !important;
}

/* ===============================================
   CONTAINER DU QUIZ - ESPACEMENT AMÉLIORÉ
   =============================================== */

/* Container principal - Plus d'espace interne */
.quiz-force-center .quiz-container {
  position: relative !important;
  width: 90% !important;
  max-width: 900px !important;
  max-height: 95vh !important;
  min-height: auto !important;
  margin: 0 auto !important;
  padding: var(--spacing-lg) !important;
  /* Contraste amélioré - fond plus opaque */
  background: rgba(40, 20, 10, 0.95) !important;
  border: 3px solid rgba(139, 69, 19, 0.8) !important;
  border-radius: var(--radius-xl) !important;
  box-shadow: 0px 12px 32px rgba(0, 0, 0, 0.4), 0px 4px 16px rgba(139, 69, 19, 0.3) !important;
  backdrop-filter: blur(20px) !important;
  transform: translateY(0) !important;
  top: auto !important;
  left: auto !important;
  right: auto !important;
  bottom: auto !important;
  overflow-y: auto !important;
  overflow-x: hidden !important;
  transition: all var(--transition-normal) !important;
  color: var(--grammar-dark-text) !important;
}

/* Mode Clair - Contraste amélioré */
.quiz-force-center[data-theme="light"] .quiz-container {
  background: rgba(255, 248, 240, 0.95) !important;
  border: 3px solid rgba(139, 69, 19, 0.6) !important;
  box-shadow: 0px 12px 32px rgba(0, 0, 0, 0.2), 0px 4px 16px rgba(218, 165, 32, 0.3) !important;
  color: var(--grammar-light-text) !important;
}

/* ===============================================
   HEADER ET NAVIGATION - ESPACEMENT AMÉLIORÉ
   =============================================== */

.quiz-force-center .header-section {
  display: flex;
  align-items: center;
  justify-content: space-between;
  margin-bottom: var(--spacing-lg) !important;
  padding-bottom: var(--spacing-md) !important;
  border-bottom: 2px solid var(--grammar-dark-border);
}

[data-theme="light"] .quiz-force-center .header-section {
  border-color: var(--grammar-light-border);
}

.quiz-force-center .modern-back-button {
  display: flex;
  align-items: center;
  gap: var(--spacing-sm);
  padding: var(--spacing-lg) var(--spacing-xl) !important;
  background: var(--grammar-dark-card);
  color: var(--grammar-dark-text);
  border: 2px solid var(--grammar-dark-border);
  border-radius: var(--radius-lg);
  font-weight: 600;
  font-size: 14px;
  transition: all var(--transition-fast);
  cursor: pointer;
  text-decoration: none;
  box-shadow: var(--shadow-sm);
  backdrop-filter: blur(10px);
}

.quiz-force-center .modern-back-button:hover {
  background: var(--grammar-dark-primary);
  color: var(--grammar-dark-text);
  border-color: var(--grammar-dark-primary);
  transform: translateY(-2px);
  box-shadow: var(--shadow-md);
}

[data-theme="light"] .quiz-force-center .modern-back-button {
  background: var(--grammar-light-card);
  border-color: var(--grammar-light-border);
  color: var(--grammar-light-text);
}

[data-theme="light"] .quiz-force-center .modern-back-button:hover {
  background: var(--grammar-light-primary);
  border-color: var(--grammar-light-primary);
  color: var(--grammar-light-text);
}

/* ===============================================
   TITRE ET DESCRIPTION - MASQUER LE TITRE QUIZ MODE
   =============================================== */

.quiz-force-center .quiz-title {
  display: none !important; /* Masquer complètement le titre Quiz Mode */
}

.quiz-force-center .quiz-description {
  color: var(--grammar-dark-text-secondary) !important;
  text-align: center !important;
  margin-bottom: var(--spacing-2xl) !important;
  font-size: 17px !important;
  line-height: 1.6 !important;
  font-weight: 500 !important;
  max-width: 600px !important;
  margin-left: auto !important;
  margin-right: auto !important;
}

/* Mode Clair */
.quiz-force-center[data-theme="light"] .quiz-description {
  color: var(--grammar-light-text-secondary) !important;
}

/* ===============================================
   SCORE ET INFO BAR - VIES À DROITE
   =============================================== */

.quiz-force-center .quiz-score {
  text-align: center !important;
  font-size: 20px !important;
  font-weight: 700 !important;
  color: var(--grammar-dark-text) !important;
  margin-bottom: var(--spacing-md) !important;
}

/* Mode Clair */
.quiz-force-center[data-theme="light"] .quiz-score {
  color: var(--grammar-light-text) !important;
}

/* Barre d'info avec plus d'espace - vies à droite */
.quiz-force-center .quiz-info {
  display: flex !important;
  justify-content: space-between !important;
  align-items: center !important;
  /* Contraste amélioré pour la barre d'info */
  background: linear-gradient(135deg, rgba(139, 69, 19, 0.8), rgba(93, 51, 23, 0.7)) !important;
  border: 2px solid rgba(245, 222, 179, 0.6) !important;
  box-shadow: 
    0px 6px 20px rgba(0, 0, 0, 0.25),
    inset 0px 1px 4px rgba(245, 222, 179, 0.3) !important;
  padding: var(--spacing-lg) var(--spacing-xl) !important;
  border-radius: var(--radius-xl) !important;
  margin-bottom: var(--spacing-lg) !important;
  backdrop-filter: blur(15px) !important;
  color: #fff !important;
  gap: var(--spacing-lg) !important;
  /* Forcer l'ordre : timer à gauche, vies à droite */
  flex-direction: row !important;
}

/* Mode Clair */
.quiz-force-center[data-theme="light"] .quiz-info {
  background: linear-gradient(135deg, rgba(139, 69, 19, 0.85), rgba(93, 51, 23, 0.8)) !important;
  border-color: rgba(245, 222, 179, 0.8) !important;
  color: #fff !important;
}

.quiz-force-center .quiz-timer {
  font-size: 18px !important;
  font-weight: 700 !important;
  color: #fff !important;
  background: rgba(0, 0, 0, 0.3) !important;
  padding: var(--spacing-md) var(--spacing-lg) !important;
  border-radius: var(--radius-md) !important;
  border: 1px solid rgba(245, 222, 179, 0.4) !important;
  backdrop-filter: blur(10px) !important;
  text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.5) !important;
  /* Forcer l'ordre à gauche */
  order: 1 !important;
}

.quiz-force-center .quiz-lives {
  display: flex !important;
  gap: var(--spacing-sm) !important;
  align-items: center !important;
  /* Forcer l'ordre à droite */
  order: 2 !important;
  margin-left: auto !important;
}

.quiz-force-center .quiz-lives .heart {
  font-size: 26px !important;
  filter: drop-shadow(1px 1px 2px rgba(0, 0, 0, 0.3)) !important;
}

/* ===============================================
   CONTAINER DE QUESTION - CORRECTION CRITIQUE
   =============================================== */

/* Container de question forcé visible */
.quiz-force-center .quiz-question-container {
  display: flex !important;
  flex-direction: column !important;
  visibility: visible !important;
  opacity: 1 !important;
  position: relative !important;
  z-index: 50 !important;
  height: auto !important;
  min-height: 280px !important;
  max-height: none !important;
  justify-content: flex-start !important;
  /* Harmonisé avec les containers de grammarMode */
  background-color: var(--grammar-dark-card) !important;
  border: 2px solid var(--grammar-dark-border) !important;
  box-shadow: 0px 6px 16px rgba(139, 69, 19, 0.3) !important;
  border-radius: var(--radius-xl) !important;
  padding: var(--spacing-lg) !important;
  margin-bottom: var(--spacing-md) !important;
  backdrop-filter: blur(10px) !important;
  gap: var(--spacing-md) !important;
  overflow: visible !important;
}

/* Mode Clair */
.quiz-force-center[data-theme="light"] .quiz-question-container {
  background-color: var(--grammar-light-card) !important;
  border-color: var(--grammar-light-border) !important;
  box-shadow: 0px 6px 16px rgba(218, 165, 32, 0.25) !important;
}

/* ===============================================
   QUESTION - CORRECTION
   =============================================== */

/* Question forcée visible */
.quiz-force-center .quiz-question {
  display: flex !important;
  visibility: visible !important;
  opacity: 1 !important;
  position: relative !important;
  z-index: 70 !important;
  height: auto !important;
  min-height: 60px !important;
  align-items: center !important;
  justify-content: center !important;
  text-align: center !important;
  font-size: 22px !important;
  font-weight: 600 !important;
  color: var(--grammar-dark-text) !important;
  /* Harmonisé avec les questions de grammarMode */
  background: linear-gradient(135deg, rgba(139, 69, 19, 0.2), rgba(93, 51, 23, 0.15)) !important;
  border: 2px solid var(--grammar-dark-border) !important;
  border-radius: var(--radius-lg) !important;
  padding: var(--spacing-md) !important;
  margin-bottom: var(--spacing-md) !important;
  backdrop-filter: blur(10px) !important;
  transition: all var(--transition-normal) !important;
  line-height: 1.4 !important;
}

/* Mode Clair */
.quiz-force-center[data-theme="light"] .quiz-question {
  color: var(--grammar-light-text) !important;
  background: linear-gradient(135deg, rgba(218, 165, 32, 0.2), rgba(205, 133, 63, 0.15)) !important;
  border-color: var(--grammar-light-border) !important;
}

/* ===============================================
   OPTIONS DE RÉPONSE - CORRECTION CRITIQUE
   =============================================== */

/* Content wrapper forcé visible */
.quiz-force-center .quiz-content {
  display: flex !important;
  flex-direction: column !important;
  visibility: visible !important;
  opacity: 1 !important;
  position: relative !important;
  z-index: 60 !important;
  width: 100% !important;
  height: auto !important;
  gap: var(--spacing-lg) !important;
}

/* ✅ CORRECTION PRINCIPALE: Grille d'options forcée visible */
.quiz-force-center .quiz-options {
  display: grid !important;
  grid-template-columns: 1fr 1fr !important;
  grid-template-rows: 1fr 1fr !important;
  gap: var(--spacing-md) !important;
  width: 100% !important;
  min-height: 160px !important;
  margin-top: 0 !important;
  visibility: visible !important;
  opacity: 1 !important;
  position: relative !important;
  z-index: 100 !important;
}

/* ✅ CORRECTION: Options forcées visibles */
.quiz-force-center .quiz-option {
  display: flex !important;
  visibility: visible !important;
  opacity: 1 !important;
  position: relative !important;
  z-index: 101 !important;
  min-height: 60px !important;
  padding: var(--spacing-md) !important;
  font-size: 16px !important;
  font-weight: 600 !important;
  text-align: center !important;
  align-items: center !important;
  justify-content: center !important;
  /* Harmonisé avec les boutons de grammarMode */
  background: linear-gradient(135deg, var(--grammar-dark-primary), var(--grammar-dark-secondary)) !important;
  color: var(--grammar-dark-text) !important;
  border: 2px solid var(--grammar-dark-border) !important;
  border-radius: var(--radius-lg) !important;
  cursor: pointer !important;
  transition: all var(--transition-fast) !important;
  box-shadow: 0 4px 12px rgba(139, 69, 19, 0.3) !important;
  backdrop-filter: blur(10px) !important;
  line-height: 1.3 !important;
  word-wrap: break-word !important;
  hyphens: auto !important;
  overflow: visible !important;
  white-space: normal !important;
  text-overflow: clip !important;
}

.quiz-force-center .quiz-option:hover:not(:disabled) {
  background: linear-gradient(135deg, var(--grammar-dark-secondary), var(--grammar-dark-accent)) !important;
  transform: translateY(-2px) !important;
  box-shadow: 0 6px 16px rgba(139, 69, 19, 0.4) !important;
}

/* Mode Clair */
.quiz-force-center[data-theme="light"] .quiz-option {
  background: linear-gradient(135deg, var(--grammar-light-primary), var(--grammar-light-secondary)) !important;
  color: var(--grammar-light-text) !important;
  border-color: var(--grammar-light-border) !important;
  box-shadow: 0 4px 12px rgba(218, 165, 32, 0.3) !important;
}

.quiz-force-center[data-theme="light"] .quiz-option:hover:not(:disabled) {
  background: linear-gradient(135deg, var(--grammar-light-secondary), var(--grammar-light-accent)) !important;
  box-shadow: 0 6px 16px rgba(218, 165, 32, 0.4) !important;
}

/* États des options */
.quiz-force-center .quiz-option.correct {
  background: linear-gradient(135deg, #22c55e, #16a34a) !important;
  color: #fff !important;
  border-color: rgba(255, 255, 255, 0.6) !important;
  animation: pulse-correct 0.6s ease-out !important;
}

.quiz-force-center .quiz-option.incorrect {
  background: linear-gradient(135deg, #ef4444, #dc2626) !important;
  color: #fff !important;
  border-color: rgba(255, 255, 255, 0.6) !important;
  animation: shake-incorrect 0.6s ease-out !important;
}

@keyframes pulse-correct {
  0% { transform: scale(1); }
  50% { transform: scale(1.05); }
  100% { transform: scale(1); }
}

@keyframes shake-incorrect {
  0%, 100% { transform: translateX(0); }
  25% { transform: translateX(-5px); }
  75% { transform: translateX(5px); }
}

/* ===============================================
   ANTI-MASQUAGE - CORRECTION CRITIQUE
   =============================================== */

/* Forcer tous les éléments du quiz à être visibles */
.quiz-force-center .quiz-question-container,
.quiz-force-center .quiz-question-container *,
.quiz-force-center .quiz-content,
.quiz-force-center .quiz-content *,
.quiz-force-center .quiz-options,
.quiz-force-center .quiz-options *,
.quiz-force-center .quiz-option,
.quiz-force-center .quiz-option * {
  visibility: visible !important;
  opacity: 1 !important;
  position: relative !important;
  overflow: visible !important;
}

/* Correction spéciale pour les boutons */
.quiz-force-center .quiz-option {
  display: flex !important;
}

/* Anti-interference avec d'autres CSS */
body .quiz-force-center .quiz-options,
html .quiz-force-center .quiz-options,
* .quiz-force-center .quiz-options {
  display: grid !important;
  visibility: visible !important;
  opacity: 1 !important;
}

body .quiz-force-center .quiz-option,
html .quiz-force-center .quiz-option,
* .quiz-force-center .quiz-option {
  display: flex !important;
  visibility: visible !important;
  opacity: 1 !important;
}

/* ===============================================
   FEEDBACK - CENTRAGE MOBILE AMÉLIORÉ
   =============================================== */

.quiz-force-center .quiz-feedback {
  position: fixed !important;
  bottom: 60px !important;
  left: 50% !important;
  transform: translateX(-50%) !important;
  padding: var(--spacing-md) var(--spacing-lg) !important;
  border-radius: var(--radius-lg) !important;
  font-weight: 700 !important;
  font-size: 18px !important;
  z-index: 2000 !important;
  box-shadow: 0 8px 24px rgba(0, 0, 0, 0.4) !important;
  backdrop-filter: blur(15px) !important;
  text-shadow: 1px 1px 3px rgba(0, 0, 0, 0.5) !important;
  border: 3px solid !important;
  animation: feedback-appear 0.5s ease-out !important;
  text-align: center !important;
  min-width: 120px !important;
  white-space: nowrap !important;
  right: auto !important;
  margin: 0 !important;
}

@keyframes feedback-appear {
  0% {
    opacity: 0;
    transform: translateX(-50%) translateY(20px) scale(0.8);
  }
  100% {
    opacity: 1;
    transform: translateX(-50%) translateY(0) scale(1);
  }
}

.quiz-force-center .quiz-feedback.correct {
  background: linear-gradient(135deg, rgba(34, 197, 94, 0.98), rgba(22, 163, 74, 0.95)) !important;
  color: #fff !important;
  border-color: rgba(255, 255, 255, 0.9) !important;
  box-shadow: 
    0 12px 32px rgba(0, 0, 0, 0.4),
    0 0 24px rgba(34, 197, 94, 0.3) !important;
}

.quiz-force-center .quiz-feedback.incorrect {
  background: linear-gradient(135deg, rgba(239, 68, 68, 0.98), rgba(220, 38, 38, 0.95)) !important;
  color: #fff !important;
  border-color: rgba(255, 255, 255, 0.9) !important;
  box-shadow: 
    0 12px 32px rgba(0, 0, 0, 0.4),
    0 0 24px rgba(239, 68, 68, 0.3) !important;
}

/* ===============================================
   BOUTONS DE DÉMARRAGE - ESPACEMENT AMÉLIORÉ
   =============================================== */

.quiz-force-center .quiz-start-container {
  text-align: center !important;
  padding: var(--spacing-3xl) !important;
}

.quiz-force-center .quiz-start-button {
  padding: var(--spacing-xl) var(--spacing-2xl) !important;
  font-size: 20px !important;
  font-weight: 700 !important;
  /* Harmonisé avec les boutons de grammarMode */
  background: linear-gradient(45deg, var(--grammar-dark-primary), var(--grammar-dark-secondary)) !important;
  color: var(--grammar-dark-text) !important;
  border: 2px solid var(--grammar-dark-border) !important;
  border-radius: var(--radius-xl) !important;
  cursor: pointer !important;
  transition: all var(--transition-fast) !important;
  box-shadow: 0 8px 24px rgba(139, 69, 19, 0.3) !important;
  backdrop-filter: blur(10px) !important;
  margin-top: var(--spacing-lg) !important;
}

.quiz-force-center .quiz-start-button:hover {
  background: linear-gradient(45deg, var(--grammar-dark-secondary), var(--grammar-dark-accent)) !important;
  transform: translateY(-4px) !important;
  box-shadow: 0 12px 32px rgba(139, 69, 19, 0.4) !important;
}

/* Mode Clair */
.quiz-force-center[data-theme="light"] .quiz-start-button {
  background: linear-gradient(45deg, var(--grammar-light-primary), var(--grammar-light-secondary)) !important;
  color: var(--grammar-light-text) !important;
  border-color: var(--grammar-light-border) !important;
  box-shadow: 0 8px 24px rgba(218, 165, 32, 0.3) !important;
}

.quiz-force-center[data-theme="light"] .quiz-start-button:hover {
  background: linear-gradient(45deg, var(--grammar-light-secondary), var(--grammar-light-accent)) !important;
  box-shadow: 0 12px 32px rgba(218, 165, 32, 0.4) !important;
}

/* ===============================================
   DÉCOMPTE - ESPACEMENT AMÉLIORÉ
   =============================================== */

.quiz-force-center .quiz-countdown-container {
  display: flex !important;
  align-items: center !important;
  justify-content: center !important;
  height: 250px !important;
  margin: var(--spacing-2xl) 0 !important;
}

.quiz-force-center .quiz-countdown-number {
  font-size: 90px !important;
  font-weight: 900 !important;
  /* Harmonisé avec les éléments de grammarMode */
  background: linear-gradient(45deg, var(--grammar-dark-primary), var(--grammar-dark-secondary)) !important;
  -webkit-background-clip: text !important;
  -webkit-text-fill-color: transparent !important;
  background-clip: text !important;
  text-shadow: 2px 2px 8px rgba(0, 0, 0, 0.3) !important;
}

/* Mode Clair */
.quiz-force-center[data-theme="light"] .quiz-countdown-number {
  background: linear-gradient(45deg, var(--grammar-light-primary), var(--grammar-light-secondary)) !important;
  -webkit-background-clip: text !important;
  -webkit-text-fill-color: transparent !important;
}

/* ===============================================
   GAME OVER - ESPACEMENT AMÉLIORÉ
   =============================================== */

.quiz-force-center .quiz-gameover-container {
  text-align: center !important;
  padding: var(--spacing-3xl) !important;
}

.quiz-force-center .quiz-gameover-title {
  display: none !important; /* Masquer le titre Game Over aussi */
}

.quiz-force-center .quiz-gameover-score {
  font-size: 22px !important;
  font-weight: 600 !important;
  margin-bottom: var(--spacing-lg) !important;
  color: var(--grammar-dark-text) !important;
}

/* Mode Clair */
.quiz-force-center[data-theme="light"] .quiz-gameover-score {
  color: var(--grammar-light-text) !important;
}

.quiz-force-center .quiz-buttons {
  display: flex !important;
  gap: var(--spacing-lg) !important;
  justify-content: center !important;
  margin-top: var(--spacing-2xl) !important;
}

.quiz-force-center .quiz-button {
  padding: var(--spacing-lg) var(--spacing-xl) !important;
  font-size: 18px !important;
  font-weight: 600 !important;
  /* Harmonisé avec les boutons de grammarMode */
  background: linear-gradient(45deg, var(--grammar-dark-primary), var(--grammar-dark-secondary)) !important;
  color: var(--grammar-dark-text) !important;
  border: 2px solid var(--grammar-dark-border) !important;
  border-radius: var(--radius-lg) !important;
  cursor: pointer !important;
  transition: all var(--transition-fast) !important;
  box-shadow: 0 6px 16px rgba(139, 69, 19, 0.3) !important;
  backdrop-filter: blur(10px) !important;
}

.quiz-force-center .quiz-button:hover {
  background: linear-gradient(45deg, var(--grammar-dark-secondary), var(--grammar-dark-accent)) !important;
  transform: translateY(-3px) !important;
  box-shadow: 0 8px 20px rgba(139, 69, 19, 0.4) !important;
}

/* Mode Clair */
.quiz-force-center[data-theme="light"] .quiz-button {
  background: linear-gradient(45deg, var(--grammar-light-primary), var(--grammar-light-secondary)) !important;
  color: var(--grammar-light-text) !important;
  border-color: var(--grammar-light-border) !important;
  box-shadow: 0 6px 16px rgba(218, 165, 32, 0.3) !important;
}

.quiz-force-center[data-theme="light"] .quiz-button:hover {
  background: linear-gradient(45deg, var(--grammar-light-secondary), var(--grammar-light-accent)) !important;
  box-shadow: 0 8px 20px rgba(218, 165, 32, 0.4) !important;
}

/* ===============================================
   BOUTON RETOUR MOBILE FLOTTANT
   =============================================== */

.quiz-force-center .mobile-header-back-button {
  position: fixed !important;
  top: var(--mobile-back-position) !important;
  left: var(--mobile-back-position) !important;
  width: var(--mobile-back-size) !important;
  height: var(--mobile-back-size) !important;
  background: var(--grammar-dark-primary) !important;
  color: var(--grammar-dark-text) !important;
  border: 3px solid var(--grammar-dark-text) !important;
  border-radius: var(--radius-full) !important;
  display: none !important; /* Masqué par défaut sur desktop */
  align-items: center !important;
  justify-content: center !important;
  cursor: pointer !important;
  z-index: var(--mobile-back-z-index) !important;
  box-shadow: var(--mobile-back-shadow) !important;
  backdrop-filter: blur(20px) !important;
  transition: all var(--transition-fast) !important;
  font-weight: 700 !important;
  font-size: 20px !important;
}

/* FORCER l'affichage sur mobile uniquement */
@media (max-width: 768px) {
  .quiz-force-center .mobile-header-back-button {
    display: flex !important;
    visibility: visible !important;
    opacity: 1 !important;
  }
}

.quiz-force-center .mobile-header-back-button:hover {
  background: var(--grammar-dark-accent) !important;
  transform: scale(1.1) !important;
  box-shadow: 0 8px 20px rgba(0, 0, 0, 0.4) !important;
}

.quiz-force-center .mobile-header-back-button:active {
  transform: scale(0.95) !important;
}

[data-theme="light"] .quiz-force-center .mobile-header-back-button {
  background: var(--grammar-light-primary) !important;
  color: var(--grammar-light-text) !important;
  border-color: var(--grammar-light-text) !important;
  box-shadow: 0 4px 12px rgba(218, 165, 32, 0.4) !important;
}

[data-theme="light"] .quiz-force-center .mobile-header-back-button:hover {
  background: var(--grammar-light-accent) !important;
  box-shadow: 0 8px 20px rgba(218, 165, 32, 0.5) !important;
}

/* ===============================================
   HEADER MOBILE LAYOUT
   =============================================== */

.quiz-force-center .grammar-header.mobile-layout {
  display: none; /* Masqué par défaut sur desktop */
  align-items: center;
  justify-content: space-between;
  padding: var(--spacing-lg) var(--spacing-xl) !important;
  background: transparent;
  border: none;
  margin-bottom: var(--spacing-lg) !important;
}

/* FORCER l'affichage sur mobile uniquement */
@media (max-width: 768px) {
  .quiz-force-center .grammar-header.mobile-layout {
    display: flex !important;
    visibility: visible !important;
    opacity: 1 !important;
  }
}

.quiz-force-center .grammar-mobile-title {
  flex: 1;
  text-align: center;
  font-size: 22px !important;
  font-weight: 700;
  color: var(--grammar-dark-text);
  margin: 0;
  padding: 0 var(--spacing-lg) !important;
}

[data-theme="light"] .quiz-force-center .grammar-mobile-title {
  color: var(--grammar-light-text);
}

.quiz-force-center .grammar-header-spacer {
  width: var(--mobile-back-size);
  height: var(--mobile-back-size);
  flex-shrink: 0;
}

/* ===============================================
   RESPONSIVE DESIGN - MOBILE AMÉLIORÉ
   =============================================== */

@media (max-width: 768px) {
  .quiz-force-center {
    padding: var(--spacing-xs) !important;
  }

  .quiz-force-center .quiz-container {
    width: 98% !important;
    max-height: 98vh !important;
    margin: 0 !important;
    padding: var(--spacing-sm) !important;
  }

  .quiz-force-center .header-section {
    display: none !important;
  }

  .quiz-force-center .modern-back-button {
    display: none !important;
  }

  .quiz-force-center .quiz-title {
    display: none !important; /* Masquer sur mobile aussi */
  }

  .quiz-force-center .quiz-score {
    font-size: 16px !important;
    margin-bottom: var(--spacing-xs) !important;
  }

  .quiz-force-center .quiz-info {
    flex-direction: row !important; /* Garder horizontal même sur mobile */
    gap: var(--spacing-md) !important;
    text-align: center !important;
    padding: var(--spacing-sm) !important;
    margin-bottom: var(--spacing-md) !important;
    justify-content: space-between !important; /* Timer à gauche, vies à droite */
  }

  .quiz-force-center .quiz-question-container {
    min-height: 180px !important;
    padding: var(--spacing-sm) !important;
    gap: var(--spacing-sm) !important;
    margin-bottom: var(--spacing-xs) !important;
  }

  .quiz-force-center .quiz-question {
    font-size: 17px !important;
    min-height: 45px !important;
    padding: var(--spacing-sm) !important;
    line-height: 1.4 !important;
    margin-bottom: var(--spacing-sm) !important;
  }

  .quiz-force-center .quiz-options {
    display: grid !important;
    grid-template-columns: 1fr 1fr !important;
    grid-template-rows: 1fr 1fr !important;
    gap: var(--spacing-sm) !important;
    min-height: 110px !important;
    visibility: visible !important;
    opacity: 1 !important;
    position: relative !important;
    z-index: 100 !important;
  }

  .quiz-force-center .quiz-option {
    display: flex !important;
    visibility: visible !important;
    opacity: 1 !important;
    font-size: 14px !important;
    padding: var(--spacing-sm) !important;
    min-height: 45px !important;
    line-height: 1.3 !important;
    white-space: normal !important;
    word-wrap: break-word !important;
  }

  .quiz-force-center .quiz-feedback {
    bottom: 40px !important;
    font-size: 16px !important;
    padding: var(--spacing-sm) var(--spacing-md) !important;
    min-width: 140px !important;
    max-width: 85vw !important;
  }

  .quiz-force-center .quiz-countdown-number {
    font-size: 60px !important;
  }

  .quiz-force-center .quiz-countdown-container {
    height: 200px !important;
    margin: var(--spacing-xl) 0 !important;
  }

  .quiz-force-center .quiz-timer {
    font-size: 16px !important;
    padding: var(--spacing-sm) var(--spacing-md) !important;
  }

  .quiz-force-center .quiz-lives .heart {
    font-size: 22px !important;
  }

  .quiz-force-center .quiz-start-container,
  .quiz-force-center .quiz-gameover-container {
    padding: var(--spacing-xl) !important;
  }

  .quiz-force-center .quiz-start-button {
    padding: var(--spacing-lg) var(--spacing-xl) !important;
    font-size: 18px !important;
    margin-top: var(--spacing-lg) !important;
  }

  .quiz-force-center .quiz-description {
    font-size: 16px !important;
    line-height: 1.5 !important;
    margin-bottom: var(--spacing-xl) !important;
    padding: 0 var(--spacing-md) !important;
  }
}

/* Très petits écrans */
@media (max-width: 480px) {
  .quiz-force-center .quiz-container {
    max-height: 99vh !important;
    padding: var(--spacing-xs) !important;
  }

  .quiz-force-center .quiz-question-container {
    min-height: 160px !important;
    padding: var(--spacing-xs) !important;
  }

  .quiz-force-center .quiz-question {
    min-height: 35px !important;
    font-size: 15px !important;
    padding: var(--spacing-xs) !important;
  }

  .quiz-force-center .quiz-options {
    min-height: 90px !important;
    gap: var(--spacing-xs) !important;
  }

  .quiz-force-center .quiz-option {
    min-height: 35px !important;
    font-size: 12px !important;
    padding: var(--spacing-xs) !important;
  }

  .quiz-force-center .quiz-info {
    padding: var(--spacing-xs) !important;
    margin-bottom: var(--spacing-xs) !important;
  }

  :root {
    --mobile-back-size: 52px;
    --mobile-back-position: 16px;
  }
}

/* Mode paysage sur mobile */
@media (max-width: 768px) and (orientation: landscape) {
  .quiz-force-center .quiz-container {
    max-height: 95vh !important;
    padding: var(--spacing-xs) !important;
  }

  .quiz-force-center .quiz-question-container {
    min-height: 140px !important;
  }

  .quiz-force-center .quiz-options {
    min-height: 80px !important;
  }

  .quiz-force-center .quiz-option {
    min-height: 30px !important;
    font-size: 12px !important;
  }
}

/* ===============================================
   ANIMATIONS AMÉLIORÉES
   =============================================== */

@keyframes quiz-fade-in {
  from {
    opacity: 0;
    transform: translateY(30px) scale(0.95);
  }
  to {
    opacity: 1;
    transform: translateY(0) scale(1);
  }
}

.quiz-force-center .quiz-container {
  animation: quiz-fade-in 0.6s ease-out !important;
}

@keyframes quiz-option-hover {
  0% {
    transform: translateY(0) scale(1);
  }
  50% {
    transform: translateY(-4px) scale(1.03);
  }
  100% {
    transform: translateY(-4px) scale(1.03);
  }
}

.quiz-force-center .quiz-option:hover {
  animation: quiz-option-hover 0.3s ease-out forwards !important;
}

@keyframes mobileButtonAppear {
  from {
    opacity: 0;
    transform: scale(0.3) translateY(-60px);
  }
  to {
    opacity: 1;
    transform: scale(1) translateY(0);
  }
}

.quiz-force-center .mobile-header-back-button {
  animation: mobileButtonAppear 0.5s ease-out;
}

@keyframes feedback-mobile-appear {
  0% {
    opacity: 0;
    transform: translateX(-50%) translateY(40px) scale(0.7);
  }
  50% {
    opacity: 0.8;
    transform: translateX(-50%) translateY(20px) scale(0.9);
  }
  100% {
    opacity: 1;
    transform: translateX(-50%) translateY(0) scale(1);
  }
}

.quiz-force-center .quiz-feedback {
  animation: feedback-mobile-appear 0.5s ease-out !important;
}

/* ===============================================
   ACCESSIBILITÉ
   =============================================== */

/* Réduction des animations si demandée */
@media (prefers-reduced-motion: reduce) {
  .quiz-force-center .quiz-container,
  .quiz-force-center .quiz-countdown-number,
  .quiz-force-center .quiz-option.correct,
  .quiz-force-center .quiz-option.incorrect,
  .quiz-force-center .mobile-header-back-button {
    animation: none !important;
  }

  .quiz-force-center .quiz-start-button,
  .quiz-force-center .quiz-button,
  .quiz-force-center .quiz-option,
  .quiz-force-center .modern-back-button,
  .quiz-force-center .mobile-header-back-button {
    transition: none !important;
  }

  .quiz-force-center .quiz-option:hover,
  .quiz-force-center .quiz-start-button:hover,
  .quiz-force-center .quiz-button:hover {
    transform: translateY(-2px) !important;
  }
}

/* Contraste élevé */
@media (prefers-contrast: high) {
  .quiz-force-center .quiz-question,
  .quiz-force-center .quiz-option {
    border-width: 4px !important;
  }

  .quiz-force-center .quiz-title {
    color: var(--grammar-dark-text) !important;
    font-weight: 900 !important;
    -webkit-text-fill-color: var(--grammar-dark-text) !important;
    text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.8) !important;
  }

  .quiz-force-center[data-theme="light"] .quiz-title {
    color: var(--grammar-light-text) !important;
    -webkit-text-fill-color: var(--grammar-light-text) !important;
    text-shadow: 2px 2px 4px rgba(255, 255, 255, 0.8) !important;
  }
}

/* Focus states pour l'accessibilité clavier */
.quiz-force-center .quiz-start-button:focus-visible,
.quiz-force-center .quiz-button:focus-visible,
.quiz-force-center .quiz-option:focus-visible,
.quiz-force-center .modern-back-button:focus-visible,
.quiz-force-center .mobile-header-back-button:focus-visible {
  outline: 3px solid var(--grammar-dark-primary) !important;
  outline-offset: 4px !important;
}

.quiz-force-center[data-theme="light"] .quiz-start-button:focus-visible,
.quiz-force-center[data-theme="light"] .quiz-button:focus-visible,
.quiz-force-center[data-theme="light"] .quiz-option:focus-visible,
.quiz-force-center[data-theme="light"] .modern-back-button:focus-visible,
.quiz-force-center[data-theme="light"] .mobile-header-back-button:focus-visible {
  outline-color: var(--grammar-light-primary) !important;
}

/* ===============================================
   AMÉLIORATIONS TACTILES MOBILES
   =============================================== */

@media (hover: none) and (pointer: coarse) {
  .quiz-force-center .mobile-header-back-button {
    min-width: calc(var(--mobile-back-size) + 12px) !important;
    min-height: calc(var(--mobile-back-size) + 12px) !important;
    -webkit-tap-highlight-color: rgba(139, 69, 19, 0.3);
  }

  .quiz-force-center .mobile-header-back-button:active {
    transform: scale(0.9) !important;
    transition: transform 0.15s ease !important;
  }

  .quiz-force-center .quiz-option,
  .quiz-force-center .quiz-start-button,
  .quiz-force-center .quiz-button {
    min-width: 48px !important;
    min-height: 48px !important;
    -webkit-tap-highlight-color: rgba(139, 69, 19, 0.2);
  }
}

/* ===============================================
   PERFORMANCE ET OPTIMISATIONS
   =============================================== */

/* GPU acceleration pour les éléments animés */
.quiz-force-center .quiz-container,
.quiz-force-center .quiz-option,
.quiz-force-center .quiz-countdown-number,
.quiz-force-center .quiz-start-button,
.quiz-force-center .quiz-button,
.quiz-force-center .mobile-header-back-button {
  will-change: transform !important;
  backface-visibility: hidden !important;
  transform-style: preserve-3d !important;
}

/* Optimisation des fonts */
.quiz-force-center {
  font-display: swap !important;
  text-rendering: optimizeLegibility !important;
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif !important;
}

/* Containment pour les performances */
.quiz-force-center .quiz-container {
  contain: layout style paint !important;
}

/* ===============================================
   THÈME SYSTÈME
   =============================================== */

/* Mode sombre système */
@media (prefers-color-scheme: dark) {
  .quiz-force-center:not([data-theme="light"]) {
    background: linear-gradient(135deg, var(--grammar-dark-primary) 0%, var(--grammar-dark-secondary) 50%, var(--grammar-dark-accent) 100%) !important;
    color: var(--grammar-dark-text) !important;
  }
}

/* Mode clair système */
@media (prefers-color-scheme: light) {
  .quiz-force-center:not([data-theme="dark"]) {
    background: linear-gradient(135deg, var(--grammar-light-primary) 0%, var(--grammar-light-secondary) 50%, var(--grammar-light-accent) 100%) !important;
    color: var(--grammar-light-text) !important;
  }
}

/* ===============================================
   HARMONISATION AVEC L'APPLICATION GLOBALE
   =============================================== */

/* Application du thème terre cuite dans tous les contextes */
.App[data-theme="dark"] .quiz-force-center,
[data-theme="dark"] .quiz-force-center,
.dark .quiz-force-center {
  background: linear-gradient(135deg, var(--grammar-dark-primary) 0%, var(--grammar-dark-secondary) 50%, var(--grammar-dark-accent) 100%) !important;
  color: var(--grammar-dark-text) !important;
}

.App[data-theme="light"] .quiz-force-center,
[data-theme="light"] .quiz-force-center,
.light .quiz-force-center {
  background: linear-gradient(135deg, var(--grammar-light-primary) 0%, var(--grammar-light-secondary) 50%, var(--grammar-light-accent) 100%) !important;
  color: var(--grammar-light-text) !important;
}

/* ===============================================
   CORRECTIONS POUR NAVIGATEURS
   =============================================== */

/* Fallback pour les navigateurs ne supportant pas backdrop-filter */
@supports not (backdrop-filter: blur(10px)) {
  .quiz-force-center .quiz-container {
    background-color: rgba(139, 69, 19, 0.95) !important;
  }

  .quiz-force-center[data-theme="light"] .quiz-container {
    background-color: rgba(255, 255, 255, 0.98) !important;
  }
}

/* Éviter le scroll du body quand le quiz est actif */
body:has(.quiz-force-center) {
  overflow: hidden !important;
  position: fixed !important;
  width: 100% !important;
  height: 100% !important;
}

/* Alternative pour les navigateurs ne supportant pas :has() */
body.quiz-active {
  overflow: hidden !important;
  position: fixed !important;
  width: 100% !important;
  height: 100% !important;
}

/* ===============================================
   FORCER LA VISIBILITÉ - SECTION CRITIQUE
   =============================================== */

/* S'assurer que tous les éléments respectent le box-sizing */
.quiz-force-center *,
.quiz-force-center *::before,
.quiz-force-center *::after {
  box-sizing: border-box !important;
}

/* S'assurer que le quiz reste toujours au premier plan */
.quiz-force-center {
  z-index: 999999 !important;
  isolation: isolate;
}

/* Assurer la visibilité des éléments critiques */
.quiz-force-center .quiz-title,
.quiz-force-center .quiz-question,
.quiz-force-center .quiz-option,
.quiz-force-center .quiz-start-button,
.quiz-force-center .quiz-button {
  position: relative !important;
  z-index: 10 !important;
}

/* Protection contre les modifications externes */
.quiz-force-center .quiz-container,
.quiz-force-center .quiz-question-container,
.quiz-force-center .quiz-options {
  position: relative !important;
  transform: none !important;
  top: auto !important;
  left: auto !important;
  right: auto !important;
  bottom: auto !important;
}

/* Force le centrage sur tous les appareils */
.quiz-force-center .quiz-feedback {
  position: fixed !important;
  left: 50% !important;
  transform: translateX(-50%) !important;
  right: auto !important;
  margin: 0 !important;
  text-align: center !important;
  white-space: nowrap !important;
  min-width: 160px !important;
}